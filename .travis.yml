language: java
jdk:
  - oraclejdk8

env:
  - MYSQL_HOST=127.0.0.1 MYSQL_USER=root

services:
  - mysql

sudo: false
install: true

script:
  - ./gradlew build
  - ./gradlew war
  - ./gradlew test --info

after_success:
  - mkdir codedeploy
  - zip -r csye6225-webapp.zip build/libs/ROOT.war appspec.yml
  - ls -al
  - mv csye6225-webapp.zip codedeploy/
  - pwd
  - cd codedeploy
  - ls -al
  - pwd

before_deploy:
  - cd ..

deploy:
  - provider: s3
    access_key_id: AKIAIYECRDTJRXB5VBAA
    secret_access_key:
      secure: "PS1EhLZnT6BTRK/THktRB+ZizvWFLw7EyWWQVgRp9Ju2ae6ie1P+UfMYBd0HDjQgWMU8hUcHqsfv+a8Ck4UjMHC87N0pYMo6/QYt75hamv7oRJ4far/BOX91bT7F40j9U4GM6zXI/pELgVG2qBZAEzkofbOGeWZUbtBF0p5ZiyCr6PQ+09Hx80/YeSlcp7voBiCgAonoRz9caILEQS5QGXtI1YwYRc/01UYlVUHSvfp/GsXljK4qq4kNQGoLmp5PPjoVqpSQQwlfObnXJ6ytDCoLN9KZahGKJRr8SdV9HQoGO/XqiyQynnc9nZ52XnUw2BiRvgZlyngBG7tEX5UhhEFVrkZIgFUTIcSkY1lUBENW+7GKG9sgHirMuf2ji7IcdXwyxmXE3fg2It+hE9ieW6I5TLo6c6fr52fcl8lJ6VtgH2FMSw8EVAV4PkAya8+9DNWqMcKqi4mGVpYsMWsnPlrDmbDGiqJJNTjPBHyz8ESsXKnvAOQ+vruuxckdi5FcQMF5Uy48cdgS8NhcG4kcOGwtKoWUryJZxIfiULqhJpRla/KonkMDp4pCRERu+cj//XoDaaWFo5ow6Ld8zLhl2vqDP0PPv9F3dqrmxuuM8lenIKKM+la0e+8SFcjuGMQMjDDHOjBJ0rJ9WZLSMNN1G5uFUCqvinNNJPSccFcOt+s="
    local_dir: codedeploy
    bucket: code-deploy.csye6225-fall2017-lalwanin.me
    region: us-east-1
    skip_cleanup: true
    on:
      all_branches: true

notifications:
  email:
    recipients:
    - koticha.c@husky.neu.edu
    - merchant.n@husky.neu.edu
    - lalwani.n@husky.neu.edu
    - lakhmani.a@husky.neu.edu

    on_success: always
    on_failure: always 